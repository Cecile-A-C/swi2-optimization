# swi2-optimization
 
Scripts and files for the pumping optimization under uncertainty conducted using PESTPP-OPT and the MODFLOW-SWI2 model of the Grande-Entr√©e Island (Magdalen Islands, Quebec, Canada).

Summary of folders:

## pestpp-opt files
This folder contains the input files used for the PESTPP-OPT runs, and a folder in which linearity between pumping rates and constraints was verified (Fig. 5).

**postcalib files**: Input files for the PESTPP-OPT runs using the calibrated parameter set and posterior uncertainties.

**priorunc files**: Input files for the PESTPP-OPT runs using the calibrated parameter set and prior uncertainties.

Both of these folders have the same structure:
- **model_ouputs**: Model output files (*\*.dat* files) (observations, forecasts, constraints)
- **model_params**: Model input files such as model parameters (*\*.dat* files), pilot point kriging factors (*pp_30max.fac*), MNW2 information (*muni_wells_mnw2_data.csv*)
- **pest_files**: PEST instruction (*\*.ins*) and template (*\*.tpl*) files

- *\*.pst*: PEST control files, for different risks between 0.01 (*'0_01_'* + *'\*.pst'*) and 0.99 (*'0_99_'* +*'.\*pst'*)
- *model_run_opt_v1.py*: Python script controlling model runs, reading model input files from **model_params** and generating model output files in **model_outputs**
- *functions_model_run.py*: Python script containing functions used by *model_run_opt_v1.py*
- *preproc_IDM_20m_qgis_v6.bin*: binary file containing model spatial inputs (e.g. dem and geology grids, row & column locations of wells - generated by Qgridder)
- *'idm_transient_swi_allwells_thiem_nopumping'* + *'.hds'* or *'.zta'* or *'.bynd'*: files containing the initial conditions for the pumping optimization, i.e. initial head (*.hds*) and 50% seawater salinity (*.zta*) values at all model cells, initial head values corrected for cell-to-well drawdown (*.bynd*) at pumping well locations
- *prior_cov_matrix.jcb*: prior parameter covariance matrix used in the FOSM analysis

**linearity test**:
- Output files from model simulations with different pumping rates ranging from 0 (*'idm_opt_run_0.\*'* files) to 150 m3/day (*'idm_opt_run_150.\*'* files)
- *model_run_opt_v1.py*: Python script controlling model runs, modified to plot Fig. 5 (*\*.jpeg*)

## pestpp-opt results
This folder contains the output files of the PESTPP-OPT runs and the Python scripts used to analyze the results of pumping optimization (Fig. 2, and 7-11).

**postcalib files**: Output files from the PESTPP-OPT runs using the calibrated parameter set and posterior uncertainties.

**priorunc files**: Output files from the PESTPP-OPT runs using the calibrated parameter set and prior uncertainties.

**postproc**: Modified Jacobian ouput files (*\*.nodvar.jcb* files), in which decision variables were removed (to enable FOSM analysis).

**simulations**: Output files from two model simulations, using the calibrated parameter set and posterior uncertainties, and a risk of 0.01 (*'postcalib_0_01_idm_opt_run.\*'* files) or 0.98 (*'postcalib_0_98_idm_opt_run.\*'* files).

And files:
- *model_run_opt_v1.py*: Python script controlling model runs, modified to plot Fig. 2 and 11 (*\*.jpeg*)
- *analyze_chance_constraints.py*: Python script analyzing the PESTPP-OPT runs for different risks and plotting Fig. 7-10 (*\*.jpeg*)
- *Current_max_pumping_rates.csv*: csv file containing the current maximum pumping rates (file read by *analyze_chance_constraints.py*)

## 3) gis files
This folder contains all the shapefiles necessary to plot the pumping optimization results.